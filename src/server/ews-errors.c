#include "ews-errors.h"

static GHashTable *ews_error_hash = NULL;
static GOnce setup_error_once = G_ONCE_INIT;

static struct EwsErrorMap 
ews_conn_errors [] =
{
	{"ErrorAccessDenied",					ERROR_ACCESSDENIED},
	{"ErrorAccountDisabled",				ERROR_ACCOUNTDISABLED},
	{"ErrorAddDelegatesFailed",				ERROR_ADDDELEGATESFAILED},
	{"ErrorAddressSpaceNotFound",				ERROR_ADDRESSSPACENOTFOUND},
	{"ErrorADOperation",					ERROR_ADOPERATION},
	{"ErrorADSessionFilter",				ERROR_ADSESSIONFILTER},
	{"ErrorADUnavailable",					ERROR_ADUNAVAILABLE},
	{"ErrorAffectedTaskOccurrencesRequired",		ERROR_AFFECTEDTASKOCCURRENCESREQUIRED},
	{"ErrorAttachmentSizeLimitExceeded",			ERROR_ATTACHMENTSIZELIMITEXCEEDED},
	{"ErrorAutoDiscoverFailed",				ERROR_AUTODISCOVERFAILED},
	{"ErrorAvailabilityConfigNotFound",			ERROR_AVAILABILITYCONFIGNOTFOUND},
	{"ErrorBatchProcessingStopped",				ERROR_BATCHPROCESSINGSTOPPED},
	{"ErrorCalendarCannotMoveOrCopyOccurrence",		ERROR_CALENDARCANNOTMOVEORCOPYOCCURRENCE},
	{"ErrorCalendarCannotUpdateDeletedItem",		ERROR_CALENDARCANNOTUPDATEDELETEDITEM},
	{"ErrorCalendarCannotUseIdForOccurrenceId",		ERROR_CALENDARCANNOTUSEIDFOROCCURRENCEID},
	{"ErrorCalendarCannotUseIdForRecurringMasterId",	ERROR_CALENDARCANNOTUSEIDFORRECURRINGMASTERID},
	{"ErrorCalendarDurationIsTooLong",			ERROR_CALENDARDURATIONISTOOLONG},
	{"ErrorCalendarEndDateIsEarlierThanStartDate",		ERROR_CALENDARENDDATEISEARLIERTHANSTARTDATE},
	{"ErrorCalendarFolderIsInvalidForCalendarView",		ERROR_CALENDARFOLDERISINVALIDFORCALENDARVIEW},
	{"ErrorCalendarInvalidDayForTimeChangePattern",		ERROR_CALENDARINVALIDDAYFORTIMECHANGEPATTERN},
	{"ErrorCalendarInvalidDayForWeeklyRecurrence",		ERROR_CALENDARINVALIDDAYFORWEEKLYRECURRENCE},
	{"ErrorCalendarInvalidPropertyState",			ERROR_CALENDARINVALIDPROPERTYSTATE},
	{"ErrorCalendarInvalidRecurrence",			ERROR_CALENDARINVALIDRECURRENCE},
	{"ErrorCalendarInvalidTimeZone",			ERROR_CALENDARINVALIDTIMEZONE},
	{"ErrorCalendarIsDelegatedForAccept",			ERROR_CALENDARISDELEGATEDFORACCEPT},
	{"ErrorCalendarIsDelegatedForDecline",			ERROR_CALENDARISDELEGATEDFORDECLINE},
	{"ErrorCalendarIsDelegatedForRemove",			ERROR_CALENDARISDELEGATEDFORREMOVE},
	{"ErrorCalendarIsDelegatedForTentative",		ERROR_CALENDARISDELEGATEDFORTENTATIVE},
	{"ErrorCalendarIsNotOrganizer",				ERROR_CALENDARISNOTORGANIZER},
	{"ErrorCalendarIsOrganizerForAccept",			ERROR_CALENDARISORGANIZERFORACCEPT},
	{"ErrorCalendarIsOrganizerForDecline",			ERROR_CALENDARISORGANIZERFORDECLINE},
	{"ErrorCalendarIsOrganizerForRemove",			ERROR_CALENDARISORGANIZERFORREMOVE},
	{"ErrorCalendarIsOrganizerForTentative",		ERROR_CALENDARISORGANIZERFORTENTATIVE},
	{"ErrorCalendarMeetingRequestIsOutOfDate",		ERROR_CALENDARMEETINGREQUESTISOUTOFDATE},
	{"ErrorCalendarOccurrenceIndexIsOutOfRecurrenceRange",	ERROR_CALENDAROCCURRENCEINDEXISOUTOFRECURRENCERANGE},
	{"ErrorCalendarOccurrenceIsDeletedFromRecurrence",	ERROR_CALENDAROCCURRENCEISDELETEDFROMRECURRENCE},
	{"ErrorCalendarOutOfRange",				ERROR_CALENDAROUTOFRANGE},
	{"ErrorCalendarViewRangeTooBig",			ERROR_CALENDARVIEWRANGETOOBIG},
	{"ErrorCannotCreateCalendarItemInNonCalendarFolder",	ERROR_CANNOTCREATECALENDARITEMINNONCALENDARFOLDER},
	{"ErrorCannotCreateContactInNonContactFolder",		ERROR_CANNOTCREATECONTACTINNONCONTACTFOLDER},
	{"ErrorCannotCreatePostItemInNonMailFolder",		ERROR_CANNOTCREATEPOSTITEMINNONMAILFOLDER},
	{"ErrorCannotCreateTaskInNonTaskFolder",		ERROR_CANNOTCREATETASKINNONTASKFOLDER},
	{"ErrorCannotDeleteObject",				ERROR_CANNOTDELETEOBJECT},
	{"ErrorCannotDeleteTaskOccurrence",			ERROR_CANNOTDELETETASKOCCURRENCE},
	{"ErrorCannotOpenFileAttachment",			ERROR_CANNOTOPENFILEATTACHMENT},
	{"ErrorCannotSetCalendarPermissionOnNonCalendarFolder",	ERROR_CANNOTSETCALENDARPERMISSIONONNONCALENDARFOLDER},
	{"ErrorCannotSetNonCalendarPermissionOnCalendarFolder",	ERROR_CANNOTSETNONCALENDARPERMISSIONONCALENDARFOLDER},
	{"ErrorCannotSetPermissionUnknownEntries",		ERROR_CANNOTSETPERMISSIONUNKNOWNENTRIES},
	{"ErrorCannotUseFolderIdForItemId",			ERROR_CANNOTUSEFOLDERIDFORITEMID},
	{"ErrorCannotUseItemIdForFolderId",			ERROR_CANNOTUSEITEMIDFORFOLDERID},
	{"ErrorChangeKeyRequired",				ERROR_CHANGEKEYREQUIRED},
	{"ErrorChangeKeyRequiredForWriteOperations",		ERROR_CHANGEKEYREQUIREDFORWRITEOPERATIONS},
	{"ErrorConnectionFailed",				ERROR_CONNECTIONFAILED},
	{"ErrorContentConversionFailed",			ERROR_CONTENTCONVERSIONFAILED},
	{"ErrorCorruptData",					ERROR_CORRUPTDATA},
	{"ErrorCreateItemAccessDenied",				ERROR_CREATEITEMACCESSDENIED},
	{"ErrorCreateManagedFolderPartialCompletion",		ERROR_CREATEMANAGEDFOLDERPARTIALCOMPLETION},
	{"ErrorCreateSubfolderAccessDenied",			ERROR_CREATESUBFOLDERACCESSDENIED},
	{"ErrorCrossMailboxMoveCopy",				ERROR_CROSSMAILBOXMOVECOPY},
	{"ErrorDataSizeLimitExceeded",				ERROR_DATASIZELIMITEXCEEDED},
	{"ErrorDataSourceOperation",				ERROR_DATASOURCEOPERATION},
	{"ErrorDelegateAlreadyExists",				ERROR_DELEGATEALREADYEXISTS},
	{"ErrorDelegateCannotAddOwner",				ERROR_DELEGATECANNOTADDOWNER},
	{"ErrorDelegateMissingConfiguration",			ERROR_DELEGATEMISSINGCONFIGURATION},
	{"ErrorDelegateNoUser",					ERROR_DELEGATENOUSER},
	{"ErrorDelegateValidationFailed",			ERROR_DELEGATEVALIDATIONFAILED},
	{"ErrorDeleteDistinguishedFolder",			ERROR_DELETEDISTINGUISHEDFOLDER},
	{"ErrorDistinguishedUserNotSupported",			ERROR_DISTINGUISHEDUSERNOTSUPPORTED},
	{"ErrorDuplicateInputFolderNames",			ERROR_DUPLICATEINPUTFOLDERNAMES},
	{"ErrorDuplicateUserIdsSpecified",			ERROR_DUPLICATEUSERIDSSPECIFIED},
	{"ErrorEmailAddressMismatch",				ERROR_EMAILADDRESSMISMATCH},
	{"ErrorEventNotFound",					ERROR_EVENTNOTFOUND},
	{"ErrorExpiredSubscription",				ERROR_EXPIREDSUBSCRIPTION},
	{"ErrorFolderCorrupt",					ERROR_FOLDERCORRUPT},
	{"ErrorFolderExists",					ERROR_FOLDEREXISTS},
	{"ErrorFolderNotFound",					ERROR_FOLDERNOTFOUND},
	{"ErrorFolderPropertRequestFailed",			ERROR_FOLDERPROPERTREQUESTFAILED},
	{"ErrorFolderSave",					ERROR_FOLDERSAVE},
	{"ErrorFolderSaveFailed",				ERROR_FOLDERSAVEFAILED},
	{"ErrorFolderSavePropertyError",			ERROR_FOLDERSAVEPROPERTYERROR},
	{"ErrorFreeBusyGenerationFailed",			ERROR_FREEBUSYGENERATIONFAILED},
	{"ErrorImpersonateUserDenied",				ERROR_IMPERSONATEUSERDENIED},
	{"ErrorImpersonationDenied",				ERROR_IMPERSONATIONDENIED},
	{"ErrorImpersonationFailed",				ERROR_IMPERSONATIONFAILED},
	{"ErrorIncorrectSchemaVersion",				ERROR_INCORRECTSCHEMAVERSION},
	{"ErrorIncorrectUpdatePropertyCount",			ERROR_INCORRECTUPDATEPROPERTYCOUNT},
	{"ErrorIndividualMailboxLimitReached",			ERROR_INDIVIDUALMAILBOXLIMITREACHED},
	{"ErrorInsufficientResources",				ERROR_INSUFFICIENTRESOURCES},
	{"ErrorInternalServerError",				ERROR_INTERNALSERVERERROR},
	{"ErrorInternalServerTransientError",			ERROR_INTERNALSERVERTRANSIENTERROR},
	{"ErrorInvalidAccessLevel",				ERROR_INVALIDACCESSLEVEL},
	{"ErrorInvalidAttachmentId",				ERROR_INVALIDATTACHMENTID},
	{"ErrorInvalidAttachmentSubfilter",			ERROR_INVALIDATTACHMENTSUBFILTER},
	{"ErrorInvalidAttachmentSubfilterTextFilter",		ERROR_INVALIDATTACHMENTSUBFILTERTEXTFILTER},
	{"ErrorInvalidAuthorizationContext",			ERROR_INVALIDAUTHORIZATIONCONTEXT},
	{"ErrorInvalidChangeKey",				ERROR_INVALIDCHANGEKEY},
	{"ErrorInvalidClientSecurityContext",			ERROR_INVALIDCLIENTSECURITYCONTEXT},
	{"ErrorInvalidCompleteDate",				ERROR_INVALIDCOMPLETEDATE},
	{"ErrorInvalidCrossForestCredentials",			ERROR_INVALIDCROSSFORESTCREDENTIALS},
	{"ErrorInvalidDelegatePermission",			ERROR_INVALIDDELEGATEPERMISSION},
	{"ErrorInvalidDelegateUserId",				ERROR_INVALIDDELEGATEUSERID},
	{"ErrorInvalidExchangeImpersonationHeaderData",		ERROR_INVALIDEXCHANGEIMPERSONATIONHEADERDATA},
	{"ErrorInvalidExcludesRestriction",			ERROR_INVALIDEXCLUDESRESTRICTION},
	{"ErrorInvalidExtendedProperty",			ERROR_INVALIDEXTENDEDPROPERTY},
	{"ErrorInvalidExtendedPropertyValue",			ERROR_INVALIDEXTENDEDPROPERTYVALUE},
	{"ErrorInvalidFolderId",				ERROR_INVALIDFOLDERID},
	{"ErrorInvalidFolderTypeForOperation",			ERROR_INVALIDFOLDERTYPEFOROPERATION},
	{"ErrorInvalidFractionalPagingParameters",		ERROR_INVALIDFRACTIONALPAGINGPARAMETERS},
	{"ErrorInvalidFreeBusyViewType",			ERROR_INVALIDFREEBUSYVIEWTYPE},
	{"ErrorInvalidId",					ERROR_INVALIDID},
	{"ErrorInvalidIdEmpty",					ERROR_INVALIDIDEMPTY},
	{"ErrorInvalidIdMalformed",				ERROR_INVALIDIDMALFORMED},
	{"ErrorInvalidIdMalformedEwsLegacyIdFormat",		ERROR_INVALIDIDMALFORMEDEWSLEGACYIDFORMAT},
	{"ErrorInvalidIdMonikerTooLong",			ERROR_INVALIDIDMONIKERTOOLONG},
	{"ErrorInvalidIdNotAnItemAttachmentId",			ERROR_INVALIDIDNOTANITEMATTACHMENTID},
	{"ErrorInvalidIdReturnedByResolveNames",		ERROR_INVALIDIDRETURNEDBYRESOLVENAMES},
	{"ErrorInvalidIdStoreObjectIdTooLong",			ERROR_INVALIDIDSTOREOBJECTIDTOOLONG},
	{"ErrorInvalidIdTooManyAttachmentLevels",		ERROR_INVALIDIDTOOMANYATTACHMENTLEVELS},
	{"ErrorInvalidIndexedPagingParameters",			ERROR_INVALIDINDEXEDPAGINGPARAMETERS},
	{"ErrorInvalidItemForOperationAcceptItem",		ERROR_INVALIDITEMFOROPERATIONACCEPTITEM},
	{"ErrorInvalidItemForOperationCancelItem",		ERROR_INVALIDITEMFOROPERATIONCANCELITEM},
	{"ErrorInvalidItemForOperationCreateItemAttachment",	ERROR_INVALIDITEMFOROPERATIONCREATEITEMATTACHMENT},
	{"ErrorInvalidItemForOperationCreateItem",		ERROR_INVALIDITEMFOROPERATIONCREATEITEM},
	{"ErrorInvalidItemForOperationDeclineItem",		ERROR_INVALIDITEMFOROPERATIONDECLINEITEM},
	{"ErrorInvalidItemForOperationExpandDL",		ERROR_INVALIDITEMFOROPERATIONEXPANDDL},
	{"ErrorInvalidItemForOperationRemoveItem",		ERROR_INVALIDITEMFOROPERATIONREMOVEITEM},
	{"ErrorInvalidItemForOperationSendItem",		ERROR_INVALIDITEMFOROPERATIONSENDITEM},
	{"ErrorInvalidItemForOperationTentative",		ERROR_INVALIDITEMFOROPERATIONTENTATIVE},
	{"ErrorInvalidManagedFolderProperty",			ERROR_INVALIDMANAGEDFOLDERPROPERTY},
	{"ErrorInvalidManagedFolderQuota",			ERROR_INVALIDMANAGEDFOLDERQUOTA},
	{"ErrorInvalidManagedFolderSize",			ERROR_INVALIDMANAGEDFOLDERSIZE},
	{"ErrorInvalidMergedFreeBusyInterval",			ERROR_INVALIDMERGEDFREEBUSYINTERVAL},
	{"ErrorInvalidNameForNameResolution",			ERROR_INVALIDNAMEFORNAMERESOLUTION},
	{"ErrorInvalidNetworkServiceContext",			ERROR_INVALIDNETWORKSERVICECONTEXT},
	{"ErrorInvalidOperation",				ERROR_INVALIDOPERATION},
	{"ErrorInvalidPagingMaxRows",				ERROR_INVALIDPAGINGMAXROWS},
	{"ErrorInvalidParentFolder",				ERROR_INVALIDPARENTFOLDER},
	{"ErrorInvalidPercentCompleteValue",			ERROR_INVALIDPERCENTCOMPLETEVALUE},
	{"ErrorInvalidPermissionSettings",			ERROR_INVALIDPERMISSIONSETTINGS},
	{"ErrorInvalidPropertyAppend",				ERROR_INVALIDPROPERTYAPPEND},
	{"ErrorInvalidPropertyDelete",				ERROR_INVALIDPROPERTYDELETE},
	{"ErrorInvalidPropertyForExists",			ERROR_INVALIDPROPERTYFOREXISTS},
	{"ErrorInvalidPropertyForOperation",			ERROR_INVALIDPROPERTYFOROPERATION},
	{"ErrorInvalidPropertyRequest",				ERROR_INVALIDPROPERTYREQUEST},
	{"ErrorInvalidPropertySet",				ERROR_INVALIDPROPERTYSET},
	{"ErrorInvalidPropertyUpdateSentMessage",		ERROR_INVALIDPROPERTYUPDATESENTMESSAGE},
	{"ErrorInvalidPullSubscriptionId",			ERROR_INVALIDPULLSUBSCRIPTIONID},
	{"ErrorInvalidPushSubscriptionUrl",			ERROR_INVALIDPUSHSUBSCRIPTIONURL},
	{"ErrorInvalidRecipients",				ERROR_INVALIDRECIPIENTS},
	{"ErrorInvalidRecipientSubfilter",			ERROR_INVALIDRECIPIENTSUBFILTER},
	{"ErrorInvalidRecipientSubfilterComparison",		ERROR_INVALIDRECIPIENTSUBFILTERCOMPARISON},
	{"ErrorInvalidRecipientSubfilterOrder",			ERROR_INVALIDRECIPIENTSUBFILTERORDER},
	{"ErrorInvalidRecipientSubfilterTextFilter",		ERROR_INVALIDRECIPIENTSUBFILTERTEXTFILTER},
	{"ErrorInvalidReferenceItem",				ERROR_INVALIDREFERENCEITEM},
	{"ErrorInvalidRequest",					ERROR_INVALIDREQUEST},
	{"ErrorInvalidRoutingType",				ERROR_INVALIDROUTINGTYPE},
	{"ErrorInvalidScheduledOofDuration",			ERROR_INVALIDSCHEDULEDOOFDURATION},
	{"ErrorInvalidSecurityDescriptor",			ERROR_INVALIDSECURITYDESCRIPTOR},
	{"ErrorInvalidSendItemSaveSettings",			ERROR_INVALIDSENDITEMSAVESETTINGS},
	{"ErrorInvalidSerializedAccessToken",			ERROR_INVALIDSERIALIZEDACCESSTOKEN},
	{"ErrorInvalidSid",					ERROR_INVALIDSID},
	{"ErrorInvalidServerVersion",				ERROR_INVALIDSERVERVERSION},
	{"ErrorInvalidSmtpAddress",				ERROR_INVALIDSMTPADDRESS},
	{"ErrorInvalidSubscription",				ERROR_INVALIDSUBSCRIPTION},
	{"ErrorInvalidSubscriptionRequest",			ERROR_INVALIDSUBSCRIPTIONREQUEST},
	{"ErrorInvalidSyncStateData",				ERROR_INVALIDSYNCSTATEDATA},
	{"ErrorInvalidTimeInterval",				ERROR_INVALIDTIMEINTERVAL},
	{"ErrorInvalidUserInfo",				ERROR_INVALIDUSERINFO},
	{"ErrorInvalidUserOofSettings",				ERROR_INVALIDUSEROOFSETTINGS},
	{"ErrorInvalidUserPrincipalName",			ERROR_INVALIDUSERPRINCIPALNAME},
	{"ErrorInvalidUserSid",					ERROR_INVALIDUSERSID},
	{"ErrorInvalidValueForProperty",			ERROR_INVALIDVALUEFORPROPERTY},
	{"ErrorInvalidWatermark",				ERROR_INVALIDWATERMARK},
	{"ErrorIrresolvableConflict",				ERROR_IRRESOLVABLECONFLICT},
	{"ErrorItemCorrupt",					ERROR_ITEMCORRUPT},
	{"ErrorItemNotFound",					ERROR_ITEMNOTFOUND},
	{"ErrorItemPropertyRequestFailed",			ERROR_ITEMPROPERTYREQUESTFAILED},
	{"ErrorItemSave",					ERROR_ITEMSAVE},
	{"ErrorItemSavePropertyError",				ERROR_ITEMSAVEPROPERTYERROR},
	{"ErrorLogonAsNetworkServiceFailed",			ERROR_LOGONASNETWORKSERVICEFAILED},
	{"ErrorMailboxConfiguration",				ERROR_MAILBOXCONFIGURATION},
	{"ErrorMailboxDataArrayEmpty",				ERROR_MAILBOXDATAARRAYEMPTY},
	{"ErrorMailboxDataArrayTooBig",				ERROR_MAILBOXDATAARRAYTOOBIG},
	{"ErrorMailboxLogonFailed",				ERROR_MAILBOXLOGONFAILED},
	{"ErrorMailboxMoveInProgress",				ERROR_MAILBOXMOVEINPROGRESS},
	{"ErrorMailboxStoreUnavailable",			ERROR_MAILBOXSTOREUNAVAILABLE},
	{"ErrorMailRecipientNotFound",				ERROR_MAILRECIPIENTNOTFOUND},
	{"ErrorManagedFolderAlreadyExists",			ERROR_MANAGEDFOLDERALREADYEXISTS},
	{"ErrorManagedFolderNotFound",				ERROR_MANAGEDFOLDERNOTFOUND},
	{"ErrorManagedFoldersRootFailure",			ERROR_MANAGEDFOLDERSROOTFAILURE},
	{"ErrorMeetingSuggestionGenerationFailed",		ERROR_MEETINGSUGGESTIONGENERATIONFAILED},
	{"ErrorMessageDispositionRequired",			ERROR_MESSAGEDISPOSITIONREQUIRED},
	{"ErrorMessageSizeExceeded",				ERROR_MESSAGESIZEEXCEEDED},
	{"ErrorMimeContentConversionFailed",			ERROR_MIMECONTENTCONVERSIONFAILED},
	{"ErrorMimeContentInvalid",				ERROR_MIMECONTENTINVALID},
	{"ErrorMimeContentInvalidBase64String",			ERROR_MIMECONTENTINVALIDBASE64STRING},
	{"ErrorMissingArgument",				ERROR_MISSINGARGUMENT},
	{"ErrorMissingEmailAddress",				ERROR_MISSINGEMAILADDRESS},
	{"ErrorMissingEmailAddressForManagedFolder",		ERROR_MISSINGEMAILADDRESSFORMANAGEDFOLDER},
	{"ErrorMissingInformationEmailAddress",			ERROR_MISSINGINFORMATIONEMAILADDRESS},
	{"ErrorMissingInformationReferenceItemId",		ERROR_MISSINGINFORMATIONREFERENCEITEMID},
	{"ErrorMissingItemForCreateItemAttachment",		ERROR_MISSINGITEMFORCREATEITEMATTACHMENT},
	{"ErrorMissingManagedFolderId",				ERROR_MISSINGMANAGEDFOLDERID},
	{"ErrorMissingRecipients",				ERROR_MISSINGRECIPIENTS},
	{"ErrorMissingUserIdInformation",			ERROR_MISSINGUSERIDINFORMATION},
	{"ErrorMoreThanOneAccessModeSpecified",			ERROR_MORETHANONEACCESSMODESPECIFIED},
	{"ErrorMoveCopyFailed",					ERROR_MOVECOPYFAILED},
	{"ErrorMoveDistinguishedFolder",			ERROR_MOVEDISTINGUISHEDFOLDER},
	{"ErrorNameResolutionMultipleResults",			ERROR_NAMERESOLUTIONMULTIPLERESULTS},
	{"ErrorNameResolutionNoMailbox",			ERROR_NAMERESOLUTIONNOMAILBOX},
	{"ErrorNameResolutionNoResults",			ERROR_NAMERESOLUTIONNORESULTS},
	{"ErrorNoCalendar",					ERROR_NOCALENDAR},
	{"ErrorNoDestinationCASDueToKerberosRequirements",	ERROR_NODESTINATIONCASDUETOKERBEROSREQUIREMENTS},
	{"ErrorNoDestinationCASDueToSSLRequirements",		ERROR_NODESTINATIONCASDUETOSSLREQUIREMENTS},
	{"ErrorNoDestinationCASDueToVersionMismatch",		ERROR_NODESTINATIONCASDUETOVERSIONMISMATCH},
	{"ErrorNoFolderClassOverride",				ERROR_NOFOLDERCLASSOVERRIDE},
	{"ErrorNoFreeBusyAccess",				ERROR_NOFREEBUSYACCESS},
	{"ErrorNonExistentMailbox",				ERROR_NONEXISTENTMAILBOX},
	{"ErrorNonPrimarySmtpAddress",				ERROR_NONPRIMARYSMTPADDRESS},
	{"ErrorNoPropertyTagForCustomProperties",		ERROR_NOPROPERTYTAGFORCUSTOMPROPERTIES},
	{"ErrorNoRespondingCASInDestinationSite",		ERROR_NORESPONDINGCASINDESTINATIONSITE},
	{"ErrorNotDelegate",					ERROR_NOTDELEGATE},
	{"ErrorNotEnoughMemory",				ERROR_NOTENOUGHMEMORY},
	{"ErrorObjectTypeChanged",				ERROR_OBJECTTYPECHANGED},
	{"ErrorOccurrenceCrossingBoundary",			ERROR_OCCURRENCECROSSINGBOUNDARY},
	{"ErrorOccurrenceTimeSpanTooBig",			ERROR_OCCURRENCETIMESPANTOOBIG},
	{"ErrorOperationNotAllowedWithPublicFolderRoot",	ERROR_OPERATIONNOTALLOWEDWITHPUBLICFOLDERROOT},
	{"ErrorParentFolderNotFound",				ERROR_PARENTFOLDERNOTFOUND},
	{"ErrorPasswordChangeRequired",				ERROR_PASSWORDCHANGEREQUIRED},
	{"ErrorPasswordExpired",				ERROR_PASSWORDEXPIRED},
	{"ErrorPropertyUpdate",					ERROR_PROPERTYUPDATE},
	{"ErrorProxiedSubscriptionCallFailure",			ERROR_PROXIEDSUBSCRIPTIONCALLFAILURE},
	{"ErrorProxyGroupSidLimitExceeded",			ERROR_PROXYGROUPSIDLIMITEXCEEDED},
	{"ErrorProxyRequestNotAllowed",				ERROR_PROXYREQUESTNOTALLOWED},
	{"ErrorProxyRequestProcessingFailed",			ERROR_PROXYREQUESTPROCESSINGFAILED},
	{"ErrorPublicFolderRequestProcessingFailed",		ERROR_PUBLICFOLDERREQUESTPROCESSINGFAILED},
	{"ErrorPublicFolderServerNotFound",			ERROR_PUBLICFOLDERSERVERNOTFOUND},
	{"ErrorQueryFilterTooLong",				ERROR_QUERYFILTERTOOLONG},
	{"ErrorQuotaExceeded",					ERROR_QUOTAEXCEEDED},
	{"ErrorReadEventsFailed",				ERROR_READEVENTSFAILED},
	{"ErrorReadReceiptNotPending",				ERROR_READRECEIPTNOTPENDING},
	{"ErrorRecurrenceEndDateTooBig",			ERROR_RECURRENCEENDDATETOOBIG},
	{"ErrorRecurrenceHasNoOccurrence",			ERROR_RECURRENCEHASNOOCCURRENCE},
	{"ErrorRemoveDelegatesFailed",				ERROR_REMOVEDELEGATESFAILED},
	{"ErrorRequestStreamTooBig",				ERROR_REQUESTSTREAMTOOBIG},
	{"ErrorRequiredPropertyMissing",			ERROR_REQUIREDPROPERTYMISSING},
	{"ErrorResolveNamesInvalidFolderType",			ERROR_RESOLVENAMESINVALIDFOLDERTYPE},
	{"ErrorResolveNamesOnlyOneContactsFolderAllowed",	ERROR_RESOLVENAMESONLYONECONTACTSFOLDERALLOWED},
	{"ErrorResponseSchemaValidation",			ERROR_RESPONSESCHEMAVALIDATION},
	{"ErrorRestrictionTooLong",				ERROR_RESTRICTIONTOOLONG},
	{"ErrorRestrictionTooComplex",				ERROR_RESTRICTIONTOOCOMPLEX},
	{"ErrorResultSetTooBig",				ERROR_RESULTSETTOOBIG},
	{"ErrorSavedItemFolderNotFound",			ERROR_SAVEDITEMFOLDERNOTFOUND},
	{"ErrorSchemaValidation",				ERROR_SCHEMAVALIDATION},
	{"ErrorSearchFolderNotInitialized",			ERROR_SEARCHFOLDERNOTINITIALIZED},
	{"ErrorSendAsDenied",					ERROR_SENDASDENIED},
	{"ErrorSendMeetingCancellationsRequired",		ERROR_SENDMEETINGCANCELLATIONSREQUIRED},
	{"ErrorSendMeetingInvitationsOrCancellationsRequired",	ERROR_SENDMEETINGINVITATIONSORCANCELLATIONSREQUIRED},
	{"ErrorSendMeetingInvitationsRequired",			ERROR_SENDMEETINGINVITATIONSREQUIRED},
	{"ErrorSentMeetingRequestUpdate",			ERROR_SENTMEETINGREQUESTUPDATE},
	{"ErrorSentTaskRequestUpdate",				ERROR_SENTTASKREQUESTUPDATE},
	{"ErrorServerBusy",					ERROR_SERVERBUSY},
	{"ErrorServiceDiscoveryFailed",				ERROR_SERVICEDISCOVERYFAILED},
	{"ErrorStaleObject",					ERROR_STALEOBJECT},
	{"ErrorSubscriptionAccessDenied",			ERROR_SUBSCRIPTIONACCESSDENIED},
	{"ErrorSubscriptionDelegateAccessNotSupported",		ERROR_SUBSCRIPTIONDELEGATEACCESSNOTSUPPORTED},
	{"ErrorSubscriptionNotFound",				ERROR_SUBSCRIPTIONNOTFOUND},
	{"ErrorSyncFolderNotFound",				ERROR_SYNCFOLDERNOTFOUND},
	{"ErrorTimeIntervalTooBig",				ERROR_TIMEINTERVALTOOBIG},
	{"ErrorTimeoutExpired",					ERROR_TIMEOUTEXPIRED},
	{"ErrorTimeZone",					ERROR_TIMEZONE},
	{"ErrorToFolderNotFound",				ERROR_TOFOLDERNOTFOUND},
	{"ErrorTokenSerializationDenied",			ERROR_TOKENSERIALIZATIONDENIED},
	{"ErrorUnsupportedCulture",				ERROR_UNSUPPORTEDCULTURE},
	{"ErrorUnsupportedMapiPropertyType",			ERROR_UNSUPPORTEDMAPIPROPERTYTYPE},
	{"ErrorUnsupportedMimeConversion",			ERROR_UNSUPPORTEDMIMECONVERSION},
	{"ErrorUnsupportedPathForQuery",			ERROR_UNSUPPORTEDPATHFORQUERY},
	{"ErrorUnsupportedPathForSortGroup",			ERROR_UNSUPPORTEDPATHFORSORTGROUP},
	{"ErrorUnsupportedQueryFilter",				ERROR_UNSUPPORTEDQUERYFILTER},
	{"ErrorUnsupportedRecurrence",				ERROR_UNSUPPORTEDRECURRENCE},
	{"ErrorUnsupportedTypeForConversion",			ERROR_UNSUPPORTEDTYPEFORCONVERSION},
	{"ErrorUpdateDelegatesFailed",				ERROR_UPDATEDELEGATESFAILED},
	{"ErrorUpdatePropertyMismatch",				ERROR_UPDATEPROPERTYMISMATCH},
	{"ErrorVirusDetected",					ERROR_VIRUSDETECTED},
	{"ErrorVirusMessageDeleted",				ERROR_VIRUSMESSAGEDELETED},
	{"ErrorWin32InteropError",				ERROR_WIN32INTEROPERROR},
};

static gpointer
setup_error_map (gpointer data)
{
	gint i;

	ews_error_hash = g_hash_table_new	(g_str_hash, g_str_equal);
	for (i = 0; i < G_N_ELEMENTS(ews_conn_errors); i++)
		g_hash_table_insert	(ews_error_hash, (gpointer) ews_conn_errors[i].error_id, 
					 GINT_TO_POINTER (ews_conn_errors[i].error_code));
	return NULL;
}

gint
ews_get_error_code (const gchar *str)
{
	gint error_code = ERROR_UNKNOWN;
	gpointer data;

	g_once (&setup_error_once, setup_error_map, NULL);

	data = g_hash_table_lookup (ews_error_hash, (gconstpointer) str);
	if (data)
		error_code = GPOINTER_TO_INT (data);

	return error_code;
}
